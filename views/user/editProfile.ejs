
<head>

    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Edit Profile</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

   <link rel="stylesheet" href="/bootstrap.min.css">
   <link rel="stylesheet" href="/style.css">


</head>



<body  style="background-color: white;">


    <br>

<div class="container mx-auto px-4 py-8 max-w-2xl bg-gray-900 text-gray-100 rounded-xl shadow-2xl" style="background-color: white;">

    <br>

    <h2 class="text-3xl font-bold text-center text-amber-500 mb-6" style="color: black;">Edit Profile</h2>

    <!-- Profile Picture Section -->
    <div class="flex flex-col items-center mb-8">
        <img id="prfilePhoto" 
        src="<%= userData.photo ? userData.photo : 'images/Messi signup.jpg' %>"
             class="w-32 h-32 md:w-40 md:h-40 rounded-full border-4 border-amber-500 object-cover mb-4 transition-transform duration-300 hover:scale-105 shadow-lg"
             >

             <form id="profilePicForm" data-user-id="<%= userData._id %>" class="text-center" enctype="multipart/form-data">
                
                <input type="file" id="profileImage" accept="image/*" class="hidden">
            <button type="button" onclick="document.getElementById('profileImage').click()"
                    class="bg-blue-300 hover:bg-blue-500 text-gray-900 font-semibold py-2 px-4 rounded-xl transition-all duration-300 shadow-md hover:shadow-xl">
                <i class="fas fa-camera mr-2"></i>Change Photo
            </button>
        </form>
    </div>


    <!-- Personal Information Form -->
    <form id="editProfileForm" action="/userProfile/edit/<%=userData._id%>" method="post" class="space-y-6">

        
        <!-- Name -->
        <div class="space-y-2">
            <h5 class="block text-gray-400" style="color: black;">Name</h5>
            <input type="text" name="name" style="background-color: white; color: black;" value="<%= userData.name %>"
                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner" required>
        </div>

        <!-- Username -->
        <div class="space-y-2">
            <h5 class="block text-gray-400" style="color: black;">User Name</h5>
            <input type="text" name="username" style="background-color: white; color: black;" value="<%= userData.username %>"
                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner" required>
        </div>

        <!-- Phone Number -->
        <div class="space-y-2">
            <label class="block text-gray-400" style="color: black;">Phone Number</label>
            <input type="tel" name="phone" style="background-color: white; color: black; " value="<%= userData.phone %>"
                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner">
        </div>


        <button class="bg-blue-300 hover:bg-blue-500 text-gray-900 font-semibold py-2 px-4 rounded-xl transition-all duration-300 shadow-md hover:shadow-xl" >Save Changes</button>

        <hr>
        <br>
        <!-- Email  -->
         
        <h1 style="color: black; font-size: 25px;">Change Email</h1>
        <div class="space-y-2">
            <label class="block text-gray-400" style="color: black;">Email</label>
            <input type="tel" name="email" style="background-color: white; color: black; " value="<%= userData.email %>"
                    class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner">
        </div>


        <button class="bg-blue-300 hover:bg-blue-500 text-gray-900 font-semibold py-2 px-4 rounded-xl transition-all duration-300 shadow-md hover:shadow-xl" >Change Your Email</button>
        <hr>
        <br>


        <h1 style="color: black; font-size: 25px;">Change Password</h1>


        <form id="changePasswordForm" action="">


            
        <div class="space-y-2">
            <label class=" block text-gray-400" style="color: black;">Current Password</label>
            <input id="currentPassword" type="password" name="currentPassword" style="background-color: white; color: black; "
                   class="form-control w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner">
                   <small id="currentPasswordError" class="text-danger"></small>
        </div>
        <div class="space-y-2">
            <label class="block text-gray-400" style="color: black;">New Password</label>
            <input type="password" name="phone" style="background-color: white; color: black; " 
                   class="form-control w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner">
        </div>
        <div class="space-y-2">
            <label class="block text-gray-400" style="color: black;">Confirm New Password</label>
            <input type="password" name="phone" style="background-color: white; color: black; " 
                   class="form-control w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all duration-300 shadow-inner">
        </div>
        <button class="bg-blue-300 hover:bg-blue-500 text-gray-900 font-semibold py-2 px-4 rounded-xl transition-all duration-300 shadow-md hover:shadow-xl" >Change Password</button>


    </form>
   

        <div>
            <div>
    </form>
</div>

    
</body>




<script>


    const form = document.getElementById('profilePicForm');
    const userId = form.dataset.userId;


    document.getElementById('profileImage').addEventListener('change', function (e) {
        const file = e.target.files[0];
        if (!file) return;


        const formData = new FormData();
        formData.append('profileImage', file);

        fetch(`/upload-profile-pic/${userId}`, {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                  
                    document.getElementById("prfilePhoto").src = data.imagePath;
                    // document.querySelector('.profile-picture').src = data.imagePath;

                    Swal.fire('Success!', 'Profile picture updated successfully.', 'success');
                } else {
                    Swal.fire('Error!', 'Failed to upload image.', 'error');
                }
            })
            .catch(error => Swal.fire('Error!', 'Something went wrong.', 'error'));
    });



</script>

